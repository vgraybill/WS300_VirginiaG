<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="styles.css" rel="stylesheet" type="text/css">
    <link href="reset.css" rel="stylesheet" type="text/css">
   
    <title>The Pixel Patch</title>
</head>
<body>
    <header>
        <!-- Navigation and logo live here -->
        <h1>Game Logo Goes Here</h1>
        <nav>
            <ul>
                <li>Home</li>
                <li>Game Changes</li>
                <li>About</li>
        </ul>
    </nav>
    </header>

    <main>
        <!-- The game lives here -->
        <section id="game-area">
            <!-- this is the main game stage -->
            <div id="ui">
                <!-- this is the ui will be -->                
                <div id="universal-timer">
                    <!-- how much time has passed since the game loaded -->
                    <img src="timericon">
                    <p>0</p>
                </div>
                <div id="player-coins">
                    <!-- how much money the player has -->
                    <img src="coinicon">
                    <p>0</p>
                </div>
                <!-- which game mode the game is in currently, starts in grow, can be switched to .shop-mode -->
                <div id="game-mode" class="grow-mode">
                </div>

            </div>

            <div id="decor-area">
                <!-- this is the decoration pots will be, will likely just be for decoration, but if we have time we will add another game mode that allows fully grown flowers to be moved here for display -->
            </div>

            <div id="grow-area">
                <!-- this is the growing patch -->
               
                
            </div>

        </section>
    </main>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script type="text/javascript">
        'use strict';

        //populate the #grow-area with 10 equally sized plots of land

        const growArea = $('#grow-area'),
            items =['p1','p2','p3','p4','p5','p6','p7','p8','p9','p10'],
            theLength = items.length;

        // let plot = '';

        for(let i = 0; i < theLength; i++){
            let plot = $('<div>').attr('id', items[i]).addClass('plot').html('<div class="econ-ui"><p class="buy">Buy</p><p class="sell">Sell</p><p>Growth <span>0</span>%</p></div>').attr('data-amt', 0);

            growArea.append(plot)
        }

        //CODE FOR THE UI

        //start universal timer in ui
        //give user 1000 coins
        //Shop/Grow mode toggles
        //let gameMode = 0; //0 is grow mode, 1 is shop mode

        //ON PAGE LOAD

        //put plant on first plot
        //set plants growth to 0
        //set plant's growth rate to 100

        // ------------------------------
        // ------------------------------

        // START PLANT PROPERTIES

        // ------------------------------
        // ------------------------------
        // $('.plot').each( function(i){
        //     if($(this).hasClass('planted')){
                
        //     }
        let growRate = 1,             
            goalAmt = 50;
//         let amt = 0
         let flowerStage
//         let timer =setInterval(  function timePassed(){
//             ++amt
//             initialGrowth('.plant.plant1')}, 1000);

//             function initialGrowth(ele){
//                 let growthText = $(ele).parent().find('span').text(Math.round(amt/goalAmt*100))

//                 let perc = amt/goalAmt;

//                 if(perc >= 1){
//                     flowerStage = 'lightblue'
//                 }else if(perc <= .99 && perc >= .66){
//                     flowerStage = 'green';
//                 }else if (perc >= .35 && perc < .66){
//                     flowerStage = 'lime';
//                 } else if(perc > 0 && perc < .35 ) {
//                     flowerStage = 'yellow';
//                 }
//                 $(ele).css({'background':flowerStage})
//             }

            
// //how do I set a new timer on a new flower when its summoned on a certain plot?
           

// // How the hell do I get a plant on a specific plot
//         // if (gameMode = 1){

             let plantNum = ['1', '2', '3', '4', '5', '6', '7', '8', '9']
             let i = 0;


            function buyPlant(e){
                //figure out which plot was clicked
                //check to see if has plant
                //add plant when clicked
                var targetPlot = $( e.target );
                    targetPlot = targetPlot.parents('.plot')

                if (!$(targetPlot).hasClass('planted')){
                    targetPlot.append('<div class="plant"></div>')
                    targetPlot.addClass('planted')
                    

                    //flowerGrowth starts
                
                }
                //
            }
    
            $('.buy').on('click dblclick', function (e){
                //console.log(e);
                e.stopPropagation();
                $(this).css({'visibility':'hidden'})
                //i++;
                let theID = $(this).parents('.plot').attr('id');
                //$('#'+theID)
                let jQEle = $('#'+theID); 

                theID = setInterval(  function(){

                    //console.log(jQEle)
                    let amount = (jQEle.attr('data-amt') * 1);
                    //console.log('current amount', amount)    
                    amount++;
                    //console.log(amount);
                    jQEle.attr('data-amt', amount);
                    if(amount > 99){
                        clearInterval(theID);
                    }

                    flowerGrowth(jQEle[0])
               
                }, 1000);
                buyPlant(e);

            })

            function flowerGrowth(ele){
                //console.log(ele);
                let amt = $(ele).attr('data-amt');
                let amtText = Math.round(amt/goalAmt*100)/2
                let growthText = $(ele).find('span').text(amtText)

                if(amtText >= 100){
                     flowerStage = 'lightblue';
                     $(ele).find('.sell').css({'visibility':'visible'})
                 }else if(amtText <= 99 && amtText >= 66){
                     flowerStage = 'green';
                 }else if (amtText >= 35 && amtText < 66){
                     flowerStage = 'lime';
                 } else if(amtText > 0 && amtText < 35 ) {
                     flowerStage = 'yellow';
                 }
                $(ele).children('.plant').css({'background':flowerStage})
            }

        



//         // }
//         // if(hasPlant == false){
//         //     //show buy button in shop mode
//         //     //show cost of new plant to grow in shop mode
//         // }
//         //  if (hasPlant == true && plantGrowth = 1) { //plant growth = 100% grown, figure out numeric value
//         //      //show sell button in shop mode
//         //      //show how much the plant will sell for
//         //      //show growth meter
//         //  } else {
//         //      //show growth meter
//         //  }


    </script>
</body>
</html>