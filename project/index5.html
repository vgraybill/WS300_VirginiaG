<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="styles.css" rel="stylesheet" type="text/css">
    <link href="reset.css" rel="stylesheet" type="text/css">
   
    <title>The Pixel Patch</title>
</head>
<body>
    <header>
        <!-- Navigation and logo live here -->
        <h1>Game Logo Goes Here</h1>
        <nav>
            <ul>
                <li>Home</li>
                <li>Game Changes</li>
                <li>About</li>
        </ul>
    </nav>
    </header>

    <main>
        <!-- The game lives here -->
        <section id="game-area">
            <!-- this is the main game stage -->
            <div class="flex" id="ui">
                <!-- this is the ui will be -->                
                <div class="flex" id="universal-timer">
                    <!-- how much time has passed since the game loaded -->
                    <img src="timericon">
                    <p>0</p>
                </div>
                <div class="flex" id="player-coins">
                    <!-- how much money the player has -->
                    <img src="coinicon">
                    <p>0</p>
                </div>
                <!-- which game mode the game is in currently, starts in grow, can be switched to .shop-mode -->
                <div id="game-mode" class="buy-mode">
                    Hide UI
                </div>

            </div>

            <div id="buy-area">
                <div class="buyplant">
                    <div id="plant1">0</div>
                    <p>Plant 1</p>
                </div>
               
                <div class="buyplant">
                    <div id="plant2">0</div>
                    <p>Plant 2</p>
                </div>

            </div>

            <div id="grow-area">
                <!-- this is the growing patch -->
               
                
            </div>

        </section>
    </main>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script type="text/javascript">
        'use strict';

        //populate the #grow-area with 10 equally sized plots of land

        const growArea = $('#grow-area'),
            items =['p1','p2','p3','p4','p5','p6','p7','p8','p9','p10'],
            theLength = items.length;

        // let plot = '';

        for(let i = 0; i < theLength; i++){
            let plot = $('<div>').attr('id', items[i]).addClass('plot').html('<div class="econ-ui"><p class="buy">Buy</p><p class="sell">Sell</p><div class="growth"><span></span></div>').attr('data-amt', 0).attr('data-goal', 0);

            growArea.append(plot)
        }

        //CODE FOR THE UI

        let playerCoins = 1000;
        $('#player-coins p').text(playerCoins)
        let seconds = 0;
        let minutes = 0;
        let hours = 0;
        let currenttime=0;
       
        let howLong = setInterval( function (){
            currenttime++;
    
            var hours = Math.floor((currenttime/60)/60);
       
            var minutes = Math.floor((currenttime/60)%60);
                if(minutes < 10){
                minutes = '0'+minutes;
                
           }

            var seconds = currenttime%60;
                if(seconds < 10){
                seconds = '0'+seconds;
           
           }
       
    $('#universal-timer p').text(hours+':'+ minutes +':'+seconds)
    
    }, 1000)//end timerTick()

        
    $('#game-mode').on('click', function(){
        if($('#game-mode').hasClass('buy-mode')) {
            $('#game-mode').text('Show UI')
            $('.econ-ui').css({'visibility':'hidden'})
            $('#game-mode').removeClass('buy-mode')
            $('#game-mode').addClass('grow-mode')
        }
        else if ($('#game-mode').hasClass('grow-mode')){
            $('#game-mode').text('Hide UI')
            $('.econ-ui').css({'visibility':'visible'})
            $('#game-mode').removeClass('grow-mode')
            $('#game-mode').addClass('buy-mode')
            // if ($('.plot').hasClass('full-grown1') || $('.plot').hasClass('full-grown2')){
            //     $(this).find('.sell').css({'visibility':'visible'})
            // }
        }
    })

        // ------------------------------
        // ------------------------------

        // START PLANT PROPERTIES

        // ------------------------------
        // ------------------------------

//         // if (gameMode = 1){

// vvvvvvvvvvvvvvvvvvvvvvv PLANT varient 1 vvvvvvvvvvvvvvvvvvvvvvvvvvvv


            function buyPlant1(ele){
                //figure out which plot was clicked
                //check to see if has plant
                //add plant when clicked
                var targetPlot = $(ele);

                if (!$(targetPlot).hasClass('planted')){
                    targetPlot.append('<div class="plant1"></div>')
                    targetPlot.addClass('planted')
                
                }
            }

            function flowerGrowth1(ele){
                let flowerStage
                let goalAmt = $(ele).attr('data-goal');
                let amt = $(ele).attr('data-amt');
                let amtText = Math.round(amt/goalAmt*100)
                let growthText = $(ele).find('.growth span').css({'width' : amtText+'%'})

                if(amtText >= 100){
                     flowerStage = 'url("img/daisyfull.png")';
                     $(ele).find('.sell').css({'visibility':'unset'})
                 }else if(amtText <= 99 && amtText >= 66){
                     flowerStage = 'url("img/daisy3.png")';
                 }else if (amtText >= 35 && amtText < 66){
                     flowerStage = 'url("img/daisy2.png")';
                 } else if(amtText > 5 && amtText < 35 ) {
                     flowerStage = 'url("img/daisy1.png")';
                 }
                $(ele).children('.plant1').css({'background':flowerStage})
            }

// vvvvvvvvvvvvvvvvvvvvvvv PLANT varient 2 vvvvvvvvvvvvvvvvvvvvvvvvvvvv

            function buyPlant2(ele){
                //figure out which plot was clicked
                //check to see if has plant
                //add plant when clicked
                var targetPlot = $(ele);

                if (!$(targetPlot).hasClass('planted')){
                    targetPlot.append('<div class="plant2"></div>')
                    targetPlot.addClass('planted')
                }
            }

            function flowerGrowth2(ele){
                let flowerStage
                let goalAmt = $(ele).attr('data-goal');
                let amt = $(ele).attr('data-amt');
                let amtText = Math.round(amt/goalAmt*100)
                let growthText = $(ele).find('span').css({'width' : amtText+'%'})

                if(amtText >= 100){
                     flowerStage = 'url("img/tulipfull.png")';
                     $(ele).find('.sell').css({'visibility':'unset'})
                 }else if(amtText <= 99 && amtText >= 66){
                     flowerStage = 'url("img/tulip3.png")';
                 }else if (amtText >= 35 && amtText < 66){
                     flowerStage = 'url("img/tulip2.png")';
                 } else if(amtText > 0 && amtText < 35 ) {
                     flowerStage = 'url("img/tulip1.png")';
                 }
                $(ele).children('.plant2').css({'background':flowerStage})
            }




//vvvvvvvvvvvvvvvvvvvv Event Listeners vvvvvvvvvvvvvvvvvvvvvvvvv
    
            $('.buy').on('click dblclick', function (e){
                console.log(e);
                $('.buyplant').css({'visibility':'visible'})
                let theID = $(this).parents('.plot').attr('id');
                $(this).css({'visibility':'hidden'})

                // if ($('.buyplant').css({'visibility':'visible'})){
                    
                // } )

                $('#plant1').on('click', function(e){ 
            
                    if (playerCoins >= 100){
                        let jQEle = $('#'+theID);
                        jQEle.attr('data-goal', 40) 
                        let goalAmount = (jQEle.attr('data-goal')*1);
                        console.log(goalAmount)

                        let timer = setInterval(  function(){

                            let amount = (jQEle.attr('data-amt') * 1);
                            amount++;
                            jQEle.attr('data-amt', amount);

                            if(amount+1 > goalAmount){
                                clearInterval(timer);
                                $(jQEle).removeClass('planted')
                                $(jQEle).addClass('full-grown1')
                            }
                            flowerGrowth1(jQEle[0])
                            }, 500);

                        buyPlant1(jQEle[0]);
                        
                        playerCoins=playerCoins-100;
                        $('#player-coins p').text(playerCoins)
                        $('#plant1').off('click');
                        $('#plant2').off('click');
                        $('.buyplant').css({'visibility':'hidden'})
                    }else{
                        alert('You need more coins')
                        let jQEle = $('#'+theID)
                        $(jQEle).find('.buy').css({'visibility':'unset'})
                        $('.buyplant').css({'visibility':'hidden'})
                        $('#plant1').off('click');
                        $('#plant2').off('click');
                    }



                })//end of plant1 click

                $('#plant2').on('click', function(e){ 
            
                    console.log(e)
                    if (playerCoins >= 300){
                        let jQEle = $('#'+theID);
                        jQEle.attr('data-goal', 100) 
                        let goalAmount = (jQEle.attr('data-goal')*1);
                        console.log(goalAmount)

                        let timer = setInterval(  function(){

                            let amount = (jQEle.attr('data-amt') * 1);
                            amount++;
                            jQEle.attr('data-amt', amount);

                            if(amount+1 > goalAmount){
                                clearInterval(timer);
                                $(jQEle).removeClass('planted')
                                $(jQEle).addClass('full-grown2')
                            }
                            flowerGrowth2(jQEle[0])
                            }, 500);

                        buyPlant2(jQEle[0]);
                        playerCoins=playerCoins-300;
                        $('#player-coins p').text(playerCoins)
                        $('#plant1').off('click');
                        $('#plant2').off('click');
                        $('.buyplant').css({'visibility':'hidden'})
                    } else {
                        alert('You need more coins')
                        let jQEle = $('#'+theID)
                        $(jQEle).find('.buy').css({'visibility':'unset'})
                        $('.buyplant').css({'visibility':'hidden'})
                        $('#plant1').off('click');
                        $('#plant2').off('click');
                    }
                }) //end of plant2 click

                e.stopPropagation();
                
                
            })

            $('.sell').on('click dblclick', function (e){
                let theID = $(this).parents('.plot').attr('id'),
                    jQEle = '#'+theID;

                if ($(this).parents('.plot').hasClass('full-grown1')){
                    console.log(this)

                    $(this).parents('.plot').removeClass('full-grown1');
                    $(jQEle).find('.plant1').remove();
                    $(this).css({'visibility':'hidden'});
                    $(this).siblings('.buy').css({'visibility':'unset'});
                    $(jQEle).attr('data-amt', 0);
                    $(this).siblings('div').find('span').css({'width': 0})

                    playerCoins=playerCoins+200;
                    $('#player-coins p').text(playerCoins)


                    //$(jQEle).childen('div').remove();


                    
                } else if ($(this).parents('.plot').hasClass('full-grown2')){
                    console.log(this)

                    $(this).parents('.plot').removeClass('full-grown2');
                    $(jQEle).find('.plant2').remove();
                    $(this).css({'visibility':'hidden'});
                    $(this).siblings('.buy').css({'visibility':'unset'});
                    $(jQEle).attr('data-amt', 0);
                    $(this).siblings('div').find('span').css({'width': 0})
                    playerCoins=playerCoins+500;
                    $('#player-coins p').text(playerCoins)
                    //$(jQEle).childen('div').remove();
                }

            })



            $('.plot').on('click', function(ele){
                let amount = $(this).attr('data-amt')
                let goalAmt = ($(this).attr('data-goal')*1)
                let amtText = Math.round(amount/goalAmt*100)
                console.log(amount)
                amount = amount*1
                $(this).attr('data-amt', amount)
                if (minutes>=5){
                    amount=amount+5;
                    $(this).attr('data-amt', amount)
                } else if (minutes >= 10){
                    amount = amount+10;
                    $(this).attr('data-amt', amount)
                } else {
                    amount = amount+3
                    $(this).attr('data-amt', amount)
                }
            })

//make UI toggle next!
//sparkles when the UI is toggled off?
//so much fun!


    </script>
</body>
</html>