<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="styles.css" rel="stylesheet" type="text/css">
    <link href="reset.css" rel="stylesheet" type="text/css">
   
    <title>The Pixel Patch</title>
</head>
<body>
    <header>
        <!-- Navigation and logo live here -->
        <h1>Game Logo Goes Here</h1>
        <nav>
            <ul>
                <li>Home</li>
                <li>Game Changes</li>
                <li>About</li>
        </ul>
    </nav>
    </header>

    <main>
        <!-- The game lives here -->
        <section id="game-area">
            <!-- this is the main game stage -->
            <div class="flex" id="ui">
                <!-- this is the ui will be -->                
                <div class="flex" id="universal-timer">
                    <!-- how much time has passed since the game loaded -->
                    <img src="img/timericon.png">
                    <p>0</p>
                </div>
                <div class="flex" id="player-coins">
                    <!-- how much money the player has -->
                    <img src="img/coinicon.png">
                    <p>0</p>
                </div>
                <!-- which game mode the game is in currently, starts in grow, can be switched to .shop-mode -->
                <div id="game-mode" class="buy-mode">
                    <p>Hide UI</p>
                </div>

            </div>

            <div id="buy-area">
                <div class="buyplant">
                    <div id="daisy"></div>
                    <p>Daisy</p>
                </div>
               
                <div class="buyplant">
                    <div id="tulip"></div>
                    <p>Tulip</p>
                </div>
                <div class="buyplant">
                    <div id="lilac"></div>
                    <p>Lilac</p>
                </div>
                <div class="buyplant">
                    <div id="gardenia"></div>
                    <p>Gardenia</p>
                </div>
                <div class="buyplant">
                    <div id="piranha"></div>
                    <p>Piranha</p>
                </div>

            </div>

            <div id="grow-area">
                <!-- this is the growing patch -->
               
                
            </div>

        </section>
    </main>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script type="text/javascript">
        'use strict';
        function wait(ms=0){
            return new Promise( (resolve) => {
                setTimeout(resolve,ms)
            })
        }

        //populate the #grow-area with 10 equally sized plots of land

        const growArea = $('#grow-area'),
            items =['p1','p2','p3','p4','p5','p6','p7','p8','p9','p10'],
            theLength = items.length;

        // let plot = '';

        for(let i = 0; i < theLength; i++){
            let plot = $('<div>').attr('id', items[i]).addClass('plot').html('<div class="econ-ui"><p class="buy">Buy</p><p class="sell">Sell</p><div class="growth"><span></span></div>').attr('data-amt', 0).attr('data-goal', 0);

            growArea.append(plot)
        }

        //CODE FOR THE UI

        let playerCoins = 500;
        $('#player-coins p').text(playerCoins)
        let seconds = 0;
        let minutes = 0;
        let hours = 0;
        let currenttime=0;
       
        let howLong = setInterval( function (){
            currenttime++;
    
            var hours = Math.floor((currenttime/60)/60);
       
            var minutes = Math.floor((currenttime/60)%60);
                if(minutes < 10){
                minutes = '0'+minutes;
                
           }

            var seconds = currenttime%60;
                if(seconds < 10){
                seconds = '0'+seconds;
           
           }
       
    $('#universal-timer p').text(hours+':'+ minutes +':'+seconds)
    
    }, 1000)//end timerTick()

        
    $('#game-mode').on('click', function(){
        if($('#game-mode').hasClass('buy-mode')) {
            $('#game-mode p').text('Show UI')
            $('.econ-ui').css({'visibility':'hidden'})
            $('#game-mode').removeClass('buy-mode')
            $('#game-mode').addClass('grow-mode')
        }
        else if ($('#game-mode').hasClass('grow-mode')){
            $('#game-mode p').text('Hide UI')
            $('.econ-ui').css({'visibility':'visible'})
            $('#game-mode').removeClass('grow-mode')
            $('#game-mode').addClass('buy-mode')
            // if ($('.plot').hasClass('full-grown-daisy') || $('.plot').hasClass('full-grown-tulip')){
            //     $(this).find('.sell').css({'visibility':'visible'})
            // }
        }
    })

        // ------------------------------
        // ------------------------------

        // START PLANT PROPERTIES

        // ------------------------------
        // ------------------------------

//         // if (gameMode = 1){

// vvvvvvvvvvvvvvvvvvvvvvv DAISY STUFF vvvvvvvvvvvvvvvvvvvvvvvvvvvv


            function buyDaisy(ele){
                //figure out which plot was clicked
                //check to see if has plant
                //add plant when clicked
                var targetPlot = $(ele);

                if (!$(targetPlot).hasClass('planted')){
                    targetPlot.append('<div class="daisy"></div>')
                    targetPlot.addClass('planted')
                
                }
            }

            function daisyGrowth(ele){
                let flowerStage
                let goalAmt = $(ele).attr('data-goal');
                let amt = $(ele).attr('data-amt');
                let amtText = Math.round(amt/goalAmt*100)
                let growthText = $(ele).find('.growth span').css({'width' : amtText+'%'})

                if(amtText >= 100){
                     flowerStage = 'url("img/daisyfull.png")';
                     $(ele).find('.sell').css({'visibility':'unset'})
                 }else if(amtText <= 99 && amtText >= 66){
                     flowerStage = 'url("img/daisy3.png")';
                 }else if (amtText >= 35 && amtText < 66){
                     flowerStage = 'url("img/daisy2.png")';
                 } else if(amtText > 5 && amtText < 35 ) {
                     flowerStage = 'url("img/daisy1.png")';
                 }
                $(ele).children('.daisy').css({'background':flowerStage})
            }

// vvvvvvvvvvvvvvvvvvvvvvv TULIP STUFF vvvvvvvvvvvvvvvvvvvvvvvvvvvv

            function buyTulip(ele){
                //figure out which plot was clicked
                //check to see if has plant
                //add plant when clicked
                var targetPlot = $(ele);

                if (!$(targetPlot).hasClass('planted')){
                    targetPlot.append('<div class="tulip"></div>')
                    targetPlot.addClass('planted')
                }
            }

            function tulipGrowth(ele){
                let flowerStage
                let goalAmt = $(ele).attr('data-goal');
                let amt = $(ele).attr('data-amt');
                let amtText = Math.round(amt/goalAmt*100)
                let growthText = $(ele).find('span').css({'width' : amtText+'%'})

                if(amtText >= 100){
                     flowerStage = 'url("img/tulipfull.png")';
                     $(ele).find('.sell').css({'visibility':'unset'})
                 }else if(amtText <= 99 && amtText >= 66){
                     flowerStage = 'url("img/tulip3.png")';
                 }else if (amtText >= 35 && amtText < 66){
                     flowerStage = 'url("img/tulip2.png")';
                 } else if(amtText > 0 && amtText < 35 ) {
                     flowerStage = 'url("img/tulip1.png")';
                 }
                $(ele).children('.tulip').css({'background':flowerStage})
            }


//vvvvvvvvvvvvvvvvvvvvv LILAC STUFF vvvvvvvvvvvvvvvvvvvvvvvvvv

            function buyLilac(ele){
                //figure out which plot was clicked
                //check to see if has plant
                //add plant when clicked
                var targetPlot = $(ele);

                if (!$(targetPlot).hasClass('planted')){
                    targetPlot.append('<div class="lilac"></div>')
                    targetPlot.addClass('planted')
                }
            }

            function lilacGrowth(ele){
                let flowerStage
                let goalAmt = $(ele).attr('data-goal');
                let amt = $(ele).attr('data-amt');
                let amtText = Math.round(amt/goalAmt*100)
                let growthText = $(ele).find('span').css({'width' : amtText+'%'})

                if(amtText >= 100){
                     flowerStage = 'url("img/lilacfull.png")';
                     $(ele).find('.sell').css({'visibility':'unset'})
                 }else if(amtText <= 99 && amtText >= 66){
                     flowerStage = 'url("img/lilac3.png")';
                 }else if (amtText >= 35 && amtText < 66){
                     flowerStage = 'url("img/lilac2.png")';
                 } else if(amtText > 0 && amtText < 35 ) {
                     flowerStage = 'url("img/lilac1.png")';
                 }
                $(ele).children('.lilac').css({'background':flowerStage})
            }



//vvvvvvvvvvvvvvvvvvvv Event Listeners vvvvvvvvvvvvvvvvvvvvvvvvv
    
            $('.buy').on('click dblclick', function (e){

                $('.buyplant').css({'visibility':'visible'})
                let theID = $(this).parents('.plot').attr('id');
                $(this).css({'visibility':'hidden'})

                // if ($('.buyplant').css({'visibility':'visible'})){
                    
                // } )

                $('#daisy').on('click', function(e){ 
            
                    if (playerCoins >= 100){
                        let jQEle = $('#'+theID);
                        jQEle.attr('data-goal', 40) 
                        let goalAmount = (jQEle.attr('data-goal')*1);

                        let timer = setInterval(  function(){

                            let amount = (jQEle.attr('data-amt') * 1);
                            amount++;
                            jQEle.attr('data-amt', amount);

                            if(amount+1 > goalAmount){
                                clearInterval(timer);
                                jQEle.removeClass('planted')
                                jQEle.addClass('full-grown-daisy')
                            }
                            daisyGrowth(jQEle[0])
                            }, 500);

                        buyDaisy(jQEle[0]);
                        
                        playerCoins=playerCoins-100;
                        $('#player-coins p').text(playerCoins)
                        $('#daisy').off('click');
                        $('#tulip').off('click');
                        $('#lilac').off('click');
                        $('#gardenia').off('click');

                        $('.buyplant').css({'visibility':'hidden'})
                    }else{
                        let jQEle = $('#'+theID)
                        jQEle.append('<p class="alert">You need more coins!</p>')
                        $('.alert').animate({'top':'-=50px', 'opacity':'15%'}, 1500, function(){
                            jQEle.find('.alert').remove()
                        });
                        jQEle.find('.buy').css({'visibility':'unset'})
                        $('.buyplant').css({'visibility':'hidden'})
                        $('#daisy').off('click');
                        $('#tulip').off('click');
                        $('#lilac').off('click');
                        $('#gardenia').off('click');
                    }



                })//end of daisy click

                $('#tulip').on('click', function(e){ 
            
                    if (playerCoins >= 300){
                        let jQEle = $('#'+theID);
                        jQEle.attr('data-goal', 100) 
                        let goalAmount = (jQEle.attr('data-goal')*1);

                        let timer = setInterval(  function(){

                            let amount = (jQEle.attr('data-amt') * 1);
                            amount++;
                            jQEle.attr('data-amt', amount);

                            if(amount+1 > goalAmount){
                                clearInterval(timer);
                                jQEle.removeClass('planted')
                                jQEle.addClass('full-grown-tulip')
                            }
                            tulipGrowth(jQEle[0])
                            }, 500);

                        buyTulip(jQEle[0]);
                        playerCoins=playerCoins-300;
                        $('#player-coins p').text(playerCoins)
                        $('#daisy').off('click');
                        $('#tulip').off('click');
                        $('#lilac').off('click');
                        $('#gardenia').off('click');

                        $('.buyplant').css({'visibility':'hidden'})
                    } else {
                        let jQEle = $('#'+theID)
                        jQEle.append('<p class="alert">You need more coins!</p>')
                        $('.alert').animate({'top':'-=50px', 'opacity':'15%'}, 1500, function(){
                            $(this).remove()
                        });
                        jQEle.find('.buy').css({'visibility':'unset'})
                        $('.buyplant').css({'visibility':'hidden'})
                        $('#daisy').off('click');
                        $('#tulip').off('click');
                        $('#lilac').off('click');
                        $('#gardenia').off('click');
                    }
                }) //end of tulip click


            $('#lilac').on('click', function(e){ 
            
            if (playerCoins >= 500){
                let jQEle = $('#'+theID);
                jQEle.attr('data-goal', 200) 
                let goalAmount = (jQEle.attr('data-goal')*1);
                let timer = setInterval(  function(){
                let amount = (jQEle.attr('data-amt') * 1);
                    amount++;
                    jQEle.attr('data-amt', amount);

                    if(amount+1 > goalAmount){
                        clearInterval(timer);
                        jQEle.removeClass('planted')
                        jQEle.addClass('full-grown-lilac')
                    }
                    lilacGrowth(jQEle[0])
                    }, 500);

                buyLilac(jQEle[0]);
                playerCoins=playerCoins-500;
                $('#player-coins p').text(playerCoins)
                $('#daisy').off('click');
                $('#tulip').off('click');
                $('#lilac').off('click');
                $('#gardenia').off('click');

                $('.buyplant').css({'visibility':'hidden'})
            } else {
                let jQEle = $('#'+theID)
                console.log(jQEle)
                jQEle.append('<p class="alert">You need more coins!</p>')
                $('.alert').animate({'top':'-=50px', 'opacity':'15%'}, 1500, function(){
                    $(this).remove()
                });
                jQEle.find('.buy').css({'visibility':'unset'})
                $('.buyplant').css({'visibility':'hidden'})
                $('#daisy').off('click');
                $('#tulip').off('click');
                $('#lilac').off('click');
                $('#gardenia').off('click');
                
            }
        }) //end of lilac click

                e.stopPropagation();
                
                
            })



            $('.sell').on('click dblclick', async function (e){
                let theID = $(this).parents('.plot').attr('id'),
                    jQEle = '#'+theID;

                await wait(250)


                if ($(this).parents('.plot').hasClass('full-grown-daisy')){

                    $(this).parents('.plot').removeClass('full-grown-daisy');
                    $(jQEle).find('.daisy').remove();
                    $(this).css({'visibility':'hidden'});
                    $(this).siblings('.buy').css({'visibility':'unset'});
                    $(jQEle).attr('data-amt', 0);
                    $(this).siblings('div').find('span').css({'width': 0})

                    playerCoins=playerCoins+200;
                    $('#player-coins p').text(playerCoins)


                    //$(jQEle).childen('div').remove();


                    
                } else if ($(this).parents('.plot').hasClass('full-grown-tulip')){

                    $(this).parents('.plot').removeClass('full-grown-tulip');
                    $(jQEle).find('.tulip').remove();
                    $(this).css({'visibility':'hidden'});
                    $(this).siblings('.buy').css({'visibility':'unset'});
                    $(jQEle).attr('data-amt', 0);
                    $(this).siblings('div').find('span').css({'width': 0})
                    playerCoins=playerCoins+500;
                    $('#player-coins p').text(playerCoins)
                    //$(jQEle).childen('div').remove();
               
               
               
                } else if ($(this).parents('.plot').hasClass('full-grown-lilac')){

                    $(this).parents('.plot').removeClass('full-grown-lilac');
                    $(jQEle).find('.lilac').remove();
                    $(this).css({'visibility':'hidden'});
                    $(this).siblings('.buy').css({'visibility':'unset'});
                    $(jQEle).attr('data-amt', 0);
                    $(this).siblings('div').find('span').css({'width': 0})
                    playerCoins=playerCoins+700;
                    $('#player-coins p').text(playerCoins)
                    //$(jQEle).childen('div').remove();
                }

            })



            $('.plot').on('click', function(ele){
                let amount = $(this).attr('data-amt')
                let goalAmt = ($(this).attr('data-goal')*1)
                let amtText = Math.round(amount/goalAmt*100)
                amount = amount*1
                $(this).attr('data-amt', amount)
                if (minutes>=5){
                    amount=amount+500;
                    $(this).attr('data-amt', amount)
                } 
                if (minutes >= 10){
                    amount = amount+10;
                    $(this).attr('data-amt', amount)
                } else {
                    amount = amount+3
                    $(this).attr('data-amt', amount)
                }
            })

//make UI toggle next!
//sparkles when the UI is toggled off?
//so much fun!


    </script>
</body>
</html>